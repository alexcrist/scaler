{"version":3,"sources":["components/Chart/Chart.module.css","components/App/App.module.css","components/Chart/Chart.js","components/Notes/Notes.js","constants/notes.js","constants/scales.js","util/audioPlayer.js","util/scalePlayer.js","components/App/App.js","index.js","components/Notes/Notes.module.css","util/formulaToData.js"],"names":["module","exports","W","H","COLORS","Chart","formulas","console","log","xInc","Math","PI","xRange","i","push","formulaDatas","map","f","formulaToData","e","filter","data","dataPoint","name","j","length","key","y","className","styles","chart","LineChart","width","height","CartesianGrid","stroke","strokeDasharray","verticalPoints","horizontalPoints","_","Line","type","dataKey","dot","strokeWidth","Tooltip","Notes","enabledNotes","setEnabledNotes","periodDuration","timeArmStyle","isPlaying","animationDuration","animation","notes","isEnabled","onClick","index","newEnabledNotes","oldNote","newNote","toggleNote","note","enabled","timeArm","style","NOTES","FREQS","Error","NOTE_MAP","SCALES","pitches","scale","pitch","substring","includes","context","window","AudioContext","webkitAudioContext","masterVolume","createGain","gain","value","connect","destination","interval","play","freq","oscillator","createOscillator","frequency","setValueAtTime","start","setTimeout","stop","D_MAJOR","MIN_NOTE_INDEX","floor","playIndex","stopScale","clearInterval","initailEnabledNotes","App","useState","formula","setFormula","numNotes","setNumNotes","setIsPlaying","setPeriodDuration","enabledNotesRef","useRef","useEffect","current","container","labels","inputs","input","onChange","target","Number","isNaN","disabled","xValues","minData","min","maxData","max","freqs","round","setInterval","playScale","ReactDOM","render","StrictMode","document","getElementById","replace","x","evalFormula","eval"],"mappings":"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","file":"static/js/main.88b13431.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"chart\":\"Chart_chart__2ay2D\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"App_container__16xz_\",\"inputs\":\"App_inputs__2pcYr\",\"input\":\"App_input__cnruI\",\"labels\":\"App_labels__sWrEY\",\"play\":\"App_play__3MUmt\"};","import { LineChart, Line, CartesianGrid, XAxis, YAxis, Legend, Tooltip } from 'recharts';\nimport formulaToData from '../../util/formulaToData';\nimport styles from './Chart.module.css';\n\nconst W = 730;\nconst H = 250;\nconst COLORS = [\n  '#8338ec',\n  '#ff006e',\n  '#3a86ff',\n  '#fb5607',\n  '#ffbe0b',\n];\n\nconst Chart = ({ formulas }) => {\n\n  console.log(formulas);\n\n  const xMin = 0;\n  const xMax = 2 * Math.PI;\n  const numX = 100;\n  const xInc = (xMax - xMin) / 100;\n\n  const xRange = [];\n  for (let i = 0; i < numX; i++) {\n    xRange.push(i * xInc);\n  }\n\n  const formulaDatas = formulas\n    .map(f => {\n      try {\n        return formulaToData(f, xRange);\n      } catch (e) {\n        return null;\n      }\n    })\n    .filter(f => f !== null);\n\n  const data = [];\n  for (let i = 0; i < numX; i++) {\n    const x = xRange[i];\n    const dataPoint = { name: x };\n\n    for (let j = 0; j < formulaDatas.length; j++) {\n      const key = `f${j}`;\n      const y = formulaDatas[j][i];\n      dataPoint[key] = y;\n    }\n\n    data.push(dataPoint);\n  }\n\n  return (\n    <div className={styles.chart}>\n\n      <LineChart\n        width={W}\n        height={H}\n        data={data}\n      >\n        <CartesianGrid\n          stroke='#ccc'\n          strokeDasharray='3 3' \n          verticalPoints={[0, W / 4, W / 2, 3 * W / 4, W]}\n          horizontalPoints={[0, H / 4, H / 2, 3 * H / 4, H]}\n        />\n        {formulaDatas.map((_, i) => \n          <Line\n            key={i}\n            type='monotone'\n            dataKey={`f${i}`}\n            stroke={COLORS[i % COLORS.length] + '99'}\n            dot={false}\n            strokeWidth={3}\n          />\n        )}\n\n        {/* <XAxis dataKey='name' type='number' domain={['dataMin', 'dataMax']} /> */}\n        <Tooltip />\n      </LineChart>\n\n    </div>\n  );\n}\n\nexport default Chart;\n","import styles from './Notes.module.css';\n\nconst Notes = ({ enabledNotes, setEnabledNotes, periodDuration, isPlaying }) => {\n\n  const timeArmStyle = isPlaying ? \n    { animationDuration: `${periodDuration}ms` } : \n    { animation: 'none' };\n\n  const toggleNote = (index) => {\n    const newEnabledNotes = [];\n    for (let i = 0; i < enabledNotes.length; i++) {\n      const oldNote = enabledNotes[i];\n      const newNote = i === index ? !oldNote : oldNote;\n      newEnabledNotes.push(newNote);\n    }\n    setEnabledNotes(newEnabledNotes);\n  };\n\n  return (\n    <div className={styles.notes}>\n      {enabledNotes.map((isEnabled, i) => \n        <div\n          onClick={() => toggleNote(i)}\n          className={`${styles.note} ${isEnabled ? styles.enabled : ''}`} \n        />\n      )}\n      <div\n        className={styles.timeArm}\n        style={timeArmStyle} \n      />\n    </div>\n  );\n};\n\nexport default Notes;","export const NOTES = [ \n  'C0',  'Db0', 'D0', 'Eb0', 'E0', 'F0', 'Gb0', 'G0', 'Ab0', 'A0', 'Bb0', 'B0',\n  'C1',  'Db1', 'D1', 'Eb1', 'E1', 'F1', 'Gb1', 'G1', 'Ab1', 'A1', 'Bb1', 'B1',\n  'C2',  'Db2', 'D2', 'Eb2', 'E2', 'F2', 'Gb2', 'G2', 'Ab2', 'A2', 'Bb2', 'B2',\n  'C3',  'Db3', 'D3', 'Eb3', 'E3', 'F3', 'Gb3', 'G3', 'Ab3', 'A3', 'Bb3', 'B3',\n  'C4',  'Db4', 'D4', 'Eb4', 'E4', 'F4', 'Gb4', 'G4', 'Ab4', 'A4', 'Bb4', 'B4',\n  'C5',  'Db5', 'D5', 'Eb5', 'E5', 'F5', 'Gb5', 'G5', 'Ab5', 'A5', 'Bb5', 'B5',\n  'C6',  'Db6', 'D6', 'Eb6', 'E6', 'F6', 'Gb6', 'G6', 'Ab6', 'A6', 'Bb6', 'B6',\n  'C7',  'Db7', 'D7', 'Eb7', 'E7', 'F7', 'Gb7', 'G7', 'Ab7', 'A7', 'Bb7', 'B7',\n  'C8',  'Db8', 'D8', 'Eb8', 'E8', 'F8', 'Gb8', 'G8', 'Ab8', 'A8', 'Bb8', 'B8'\n];\n\nexport const FREQS = [\n  16.35, 17.32, 18.35, 19.45, 20.60, 21.83, 23.12, 24.50, 25.96, 27.50, 29.14, \n  30.87, 32.70, 34.65, 36.71, 38.89, 41.20, 43.65, 46.25, 49.00, 51.91, 55.00, \n  58.27, 61.74, 65.41, 69.30, 73.42, 77.78, 82.41, 87.31, 92.50, 98.00, 103.83, \n  110.00, 116.54, 123.47, 130.81, 138.59, 146.83, 155.56, 164.81, 174.61, 185.00, \n  196.00, 207.65, 220.00, 233.08, 246.94, 261.63, 277.18, 293.66, 311.13, 329.63, \n  349.23, 369.99, 392.00, 415.30, 440.00, 466.16, 493.88, 523.25, 554.37, 587.33, \n  622.25, 659.25, 698.46, 739.99, 783.99, 830.61, 880.00, 932.33, 987.77, 1046.50,\n  1108.73, 1174.66, 1244.51, 1318.51, 1396.91, 1479.98, 1567.98, 1661.22, 1760.00, \n  1864.66, 1975.53, 2093.00, 2217.46, 2349.32, 2489.02, 2637.02, 2793.83, 2959.96, \n  3135.96, 3322.44, 3520.00, 3729.31, 3951.07, 4186.01, 4434.92, 4698.63, 4978.03, \n  5274.04, 5587.65, 5919.91, 6271.93, 6644.88, 7040.00, 7458.62, 7902.13\n];\n\nif (NOTES.length !== FREQS.length) {\n  throw Error('# notes !== # freqs');\n}\n\nexport const NOTE_MAP = {};\nfor (let i = 0; i < NOTES.length; i++) {\n  NOTE_MAP[NOTES[i]] = FREQS[i];\n}\n\n\n\n","import { NOTES } from \"./notes\";\n\nexport const SCALES = [\n  {\n    name: 'C major',\n    pitches: ['C', 'D', 'E', 'F', 'G', 'A', 'B'],\n    notes: []\n  },\n  {\n    name: 'D major',\n    pitches: ['D', 'E', 'Gb', 'G', 'A', 'B', 'Db'],\n    notes: []\n  }\n];\n\nfor (const scale of SCALES) {\n  for (const note of NOTES) {\n    const pitch = note.substring(0, note.length - 1);\n    if (scale.pitches.includes(pitch)) {\n      scale.notes.push(note);\n    }\n  }\n} ","var AudioContext = window.AudioContext ||\nwindow.webkitAudioContext;\n\nconst context = new AudioContext();\n\nconst masterVolume = context.createGain();\nmasterVolume.gain.value = 0.05;\nmasterVolume.connect(context.destination);\n\nexport const play = (freq) => {\n  const oscillator = context.createOscillator();\n  oscillator.connect(masterVolume);\n  oscillator.frequency.setValueAtTime(freq, 0);\n  oscillator.start(0);\n  setTimeout(() => oscillator.stop(), 100);\n};","import _ from 'lodash';\nimport { NOTES, NOTE_MAP } from \"../constants/notes\";\nimport { SCALES } from \"../constants/scales\";\nimport { play } from \"./audioPlayer\";\nimport formulaToData from './formulaToData';\n\nconst D_MAJOR = SCALES[1];\nconst MIN_NOTE_INDEX = Math.floor(D_MAJOR.notes.length * 0.42);\nconst NUM_NOTES = 12;\n\nconsole.log(NOTES[MIN_NOTE_INDEX])\n\nlet interval;\nlet playIndex = 1;\n\nexport const playScale = (formula, enabledNotesRef, periodDuration) => {\n\n  const numNotes = enabledNotesRef.current.length;\n\n  const xValues = [];\n  for (let i = 0; i < numNotes; i++) {\n    xValues.push(i / numNotes * 2 * Math.PI);\n  }\n\n  const data = formulaToData(formula, xValues);\n\n  const minData = _.min(data);\n  const maxData = _.max(data);\n\n  const noteIndices = data.map(value => {\n    return Math.round(\n      (value - minData) / \n      (maxData - minData) * \n      NUM_NOTES\n    );\n  });\n\n  const notes = noteIndices.map(index => {\n    return D_MAJOR.notes[index + MIN_NOTE_INDEX];\n  });\n\n  const freqs = notes.map(note => NOTE_MAP[note]);\n\n  const freq = freqs[0];\n  const isEnabled = enabledNotesRef.current[0];\n  if (isEnabled) {\n    play(freq);\n  }\n  playIndex = 1;\n  interval = setInterval(() => {\n    const freq = freqs[playIndex];\n    const isEnabled = enabledNotesRef.current[playIndex];\n    if (isEnabled) {\n      play(freq);\n    }\n    playIndex = (playIndex + 1) % numNotes;\n  }, periodDuration / numNotes);\n};\n\nexport const stopScale = () => {\n  clearInterval(interval);\n  playIndex = 0;\n};\n\n","import { useEffect, useRef, useState } from 'react';\nimport Chart from '../Chart/Chart';\nimport styles from './App.module.css';\nimport Notes from '../Notes/Notes';\nimport { playScale, stopScale } from '../../util/scalePlayer';\n\nconst initialNumNotes = 16;\nconst initailEnabledNotes = [];\nfor (let i = 0; i < initialNumNotes; i++) {\n  initailEnabledNotes.push(true);\n}\n\nconst App = () => {\n\n  const [formula, setFormula] = useState('y = sin(x) + cos(4*x)');\n  const [numNotes, setNumNotes] = useState(initialNumNotes);\n  const [enabledNotes, setEnabledNotes] = useState(initailEnabledNotes);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [periodDuration, setPeriodDuration] = useState(3000);\n\n  const enabledNotesRef = useRef(enabledNotes);\n  useEffect(() => {\n    enabledNotesRef.current = enabledNotes;\n  }, [enabledNotes]);\n\n  const onClickButton = () => {\n    if (isPlaying) {\n      setIsPlaying(false);\n      stopScale();\n    } else {\n      setIsPlaying(true);\n      playScale(formula, enabledNotesRef, periodDuration);\n    }\n  };\n\n  const onChangeFormula = (e) => {\n    setIsPlaying(false);\n    stopScale();\n    setFormula(e.target.value);\n  };\n\n  const onChangePeriod = (e) => {\n    setIsPlaying(false);\n    stopScale();\n    setPeriodDuration(Number(e.target.value));\n  };\n\n  const onChangeNumNotes = (e) => {\n    setIsPlaying(false);\n    stopScale();\n    setNumNotes(Number(e.target.value));\n    if (!isNaN(Number(e.target.value))) {\n      const newEnabledNotes = [];\n      for (let i = 0; i < Number(e.target.value); i++) {\n        newEnabledNotes.push(true);\n      }\n      setEnabledNotes(newEnabledNotes);\n    }\n  };\n\n  return (\n    <div className={styles.container}>\n\n      <div className={styles.labels}>\n        <label>Formula</label>\n        <label>Period (ms)</label>\n        <label>Beats</label>\n      </div>\n\n      <div className={styles.inputs}>\n        <input\n          className={styles.input}\n          value={formula}\n          onChange={onChangeFormula}\n        />\n        <input\n          className={styles.input}\n          value={periodDuration}\n          onChange={onChangePeriod}\n          type='number'\n        />\n        <input\n          className={styles.input}\n          value={numNotes}\n          onChange={onChangeNumNotes}\n          type='number'\n        />\n      </div>\n\n      <div className={styles.labels}>\n        <label>Scale</label>\n        <label>Low note</label>\n        <label>Note range</label>\n      </div>\n\n      <div className={styles.inputs}>\n        <input\n          className={styles.input}\n          value='D Major'\n          disabled\n        />\n        <input\n          className={styles.input}\n          value='D2'\n          disabled\n        />\n        <input\n          className={styles.input}\n          value='12'\n          disabled\n        />\n      </div>\n\n      <Chart formulas={[formula]} />\n\n      <Notes\n        enabledNotes={enabledNotes}\n        setEnabledNotes={setEnabledNotes}\n        isPlaying={isPlaying}\n        periodDuration={periodDuration}\n      />\n\n      <button className={styles.play} onClick={onClickButton}>\n        {isPlaying ? 'stop' : 'start'}\n      </button>\n\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './components/App/App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"notes\":\"Notes_notes__2CEZy\",\"note\":\"Notes_note__32ig5\",\"enabled\":\"Notes_enabled__34Zsz\",\"timeArm\":\"Notes_timeArm__3vyiP\",\"slide\":\"Notes_slide__18buH\"};","import _ from 'lodash';\n\n\nconst formulaToData = (formula, xValues) => {\n  formula = formula.replace(/\\s+/g, '');\n  formula = formula.replace(/sin/g, 'Math.sin');\n  formula = formula.replace(/cos/g, 'Math.cos');\n\n  if (formula.substring(0,  2) !== 'y=') {\n    throw Error('Invalid formula: ' + formula);\n  }\n\n  formula = formula.substring(2);\n\n  const data = [];\n  for (const x of xValues) {\n    const evalFormula = _.replace(formula, 'x', x);\n    try {\n      data.push(eval(evalFormula));\n    } catch (e) {\n      throw Error('Formula evaluation error: ' + evalFormula);\n    }\n  }\n\n  return data;\n};\n\nexport default formulaToData;"],"sourceRoot":""}