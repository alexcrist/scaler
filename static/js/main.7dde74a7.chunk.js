(this.webpackJsonpscaler=this.webpackJsonpscaler||[]).push([[0],{114:function(e,t,a){e.exports={createTrack:"AddTrack_createTrack__1dZTK",createTrackText:"AddTrack_createTrackText__3wNni"}},115:function(e,t,a){e.exports={play:"Play_play__2x_Gd",playText:"Play_playText__1skLF"}},153:function(e,t,a){e.exports={container:"Chart_container__1PIOn"}},170:function(e,t,a){e.exports={arm:"TimelineArm_arm__2cLiz",slide:"TimelineArm_slide__3GUfj"}},23:function(e,t,a){e.exports={container:"TrackOptions_container__2E_dx",collapsed:"TrackOptions_collapsed__X5vja",header:"TrackOptions_header__3Lfwo",icons:"TrackOptions_icons__33YYK",icon:"TrackOptions_icon__3jQrz",isMuted:"TrackOptions_isMuted__4aVJB",muteIcon:"TrackOptions_muteIcon__175TR",trashIcon:"TrackOptions_trashIcon__30wpV",title:"TrackOptions_title__1ue4w",label:"TrackOptions_label__1sLEb",input:"TrackOptions_input__3reUO"}},320:function(e,t,a){},321:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(62),s=a.n(c),o=a(15),i=a(38),l=a.n(i),u=a(18),b=a(152),d=function(e,t){if("y="!==(e=e.replace(/\s+/g,"")).substring(0,2))throw Error("Invalid formula: "+e);e=e.substring(2);var a,n=[],r=Object(u.a)(t);try{for(r.s();!(a=r.n()).done;){var c=a.value;try{var s=b.a.evaluate(e,{x:c});n.push(s)}catch(o){throw Error("Formula evaluation error: "+e)}}}catch(i){r.e(i)}finally{r.f()}return n},j=["C0","Db0","D0","Eb0","E0","F0","Gb0","G0","Ab0","A0","Bb0","B0","C1","Db1","D1","Eb1","E1","F1","Gb1","G1","Ab1","A1","Bb1","B1","C2","Db2","D2","Eb2","E2","F2","Gb2","G2","Ab2","A2","Bb2","B2","C3","Db3","D3","Eb3","E3","F3","Gb3","G3","Ab3","A3","Bb3","B3","C4","Db4","D4","Eb4","E4","F4","Gb4","G4","Ab4","A4","Bb4","B4","C5","Db5","D5","Eb5","E5","F5","Gb5","G5","Ab5","A5","Bb5","B5","C6","Db6","D6","Eb6","E6","F6","Gb6","G6","Ab6","A6","Bb6","B6","C7","Db7","D7","Eb7","E7","F7","Gb7","G7","Ab7","A7","Bb7","B7","C8","Db8","D8","Eb8","E8","F8","Gb8","G8","Ab8","A8","Bb8","B8"],m=[16.35,17.32,18.35,19.45,20.6,21.83,23.12,24.5,25.96,27.5,29.14,30.87,32.7,34.65,36.71,38.89,41.2,43.65,46.25,49,51.91,55,58.27,61.74,65.41,69.3,73.42,77.78,82.41,87.31,92.5,98,103.83,110,116.54,123.47,130.81,138.59,146.83,155.56,164.81,174.61,185,196,207.65,220,233.08,246.94,261.63,277.18,293.66,311.13,329.63,349.23,369.99,392,415.3,440,466.16,493.88,523.25,554.37,587.33,622.25,659.25,698.46,739.99,783.99,830.61,880,932.33,987.77,1046.5,1108.73,1174.66,1244.51,1318.51,1396.91,1479.98,1567.98,1661.22,1760,1864.66,1975.53,2093,2217.46,2349.32,2489.02,2637.02,2793.83,2959.96,3135.96,3322.44,3520,3729.31,3951.07,4186.01,4434.92,4698.63,4978.03,5274.04,5587.65,5919.91,6271.93,6644.88,7040,7458.62,7902.13];if(j.length!==m.length)throw Error("# notes !== # freqs");for(var p={},f=0;f<j.length;f++)p[j[f]]=m[f];var h=[{name:"C major",pitches:["C","D","E","F","G","A","B"]},{name:"D minor",pitches:["D","E","F","G","A","Bb","C"]},{name:"D major",pitches:["D","E","Gb","G","A","B","Db"]},{name:"E minor",pitches:["E","Gb","G","A","B","C","D"]},{name:"E major",pitches:["E","Gb","G","A","B","C","D"]},{name:"F minor",pitches:["F","G","Ab","Bb","C","Db","Eb"]},{name:"F major",pitches:["F","G","A","Bb","C","D","E"]},{name:"G minor",pitches:["G","A","Bb","C","D","Eb","F"]},{name:"G major",pitches:["G","A","B","C","D","E","Gb"]},{name:"A minor",pitches:["A","B","C","D","E","F","G"]},{name:"A major",pitches:["A","B","Db","D","E","Gb","Ab"]},{name:"B minor",pitches:["B","Db","D","E","Gb","G","A"]},{name:"B major",pitches:["B","Db","Eb","E","Gb","Ab","Bb"]}].map((function(e){e.notes=[];var t,a=Object(u.a)(j);try{for(a.s();!(t=a.n()).done;){var n=t.value,r=n.substring(0,n.length-1);e.pitches.includes(r)&&e.notes.push(n)}}catch(c){a.e(c)}finally{a.f()}return e})),_=new(window.AudioContext||window.webkitAudioContext),O=function(e,t){if("number"===typeof e&&!isNaN(e)&&e){t=t||85;var a=_.createGain();a.gain.setValueCurveAtTime(new Float32Array([0,.8,1,.3,0].map((function(e){return.05*e}))),_.currentTime,t/1e3),a.connect(_.destination);var n=_.createOscillator();n.connect(a),n.frequency.setValueAtTime(e,0),n.start(0),setTimeout((function(){return n.stop()}),t)}},x=function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t.current,r=n.tracks,c=n.bpm,s=n.notes,o=n.numBeats,i=n.isPlaying;if(i){for(var l=0;l<s.length;l++){var u=s[l][a],b=p[u],d=r[l],j=d.noteDuration,m=d.isMuted,f=d.disabledBeats,h=f.includes(a);m||h||O(b,j)}var _=1/c*60*1e3,x=(a+1)%o;setTimeout((function(){return e(t,x)}),_)}},v=["#8338ec","#ff006e","#3a86ff","#fb5607","#ffbe0b"],k="cc",B="#666666",g=function(){return[{color:v[0],formula:"y = sin(x)",noteDuration:80,disabledBeats:[],isMuted:!1},{color:v[1],formula:"y = (1 / (x + 0.5)) * cos(4 * x) - 2",noteDuration:300,disabledBeats:[],isMuted:!1}]},y=a(48),T=a.n(y),C=a(154),A=a(326),N=a(328),D=a(172),E=a(76),G=a(169),M=a(153),F=a.n(M),w=a(2),P=function(e){for(var t=e.tracks,a=e.numBeats,n=e.notes,r=[],c=100*a,s=0;s<c+1;s++)r.push(s*(2*Math.PI)/c);for(var o=t.map((function(e){try{return d(e.formula,r)}catch(t){return[]}})),i=r.map((function(e,t){return{x:e,i:t}})),u=0;u<o.length;u++)for(var b="Track ".concat(u+1),j=o[u],m=0;m<j.length;m++){var p=j[m];i[m][b]=p}for(var f=[],h=0;h<a+1;h++)f.push(Object(w.jsx)(C.a,{x:h/a*c,strokeDasharray:"3 3"},"x-line-".concat(h)));for(var _=[],O=Math.floor(l()(o).flatten().min()),x=Math.ceil(l()(o).flatten().max()),v=O;v<=x;v++)_.push(Object(w.jsx)(C.a,{y:v,strokeDasharray:"3 3"},"y-line-".concat(v)));return Object(w.jsx)("div",{className:F.a.container,children:Object(w.jsx)(A.a,{width:"100%",height:300,children:Object(w.jsxs)(N.a,{data:i,children:[f,_,t.map((function(e,t){return Object(w.jsx)(D.a,{type:"monotone",dataKey:"Track ".concat(t+1),stroke:e.color,opacity:e.isMuted?.4:1,dot:!1,strokeWidth:2},"line-".concat(t))})),Object(w.jsx)(E.a,{formatter:function(e,t,a){var r=a.dataKey,c=a.payload.i,s=Number(r[r.length-1])-1,o=Math.round(c/100);return n[s][o]},labelFormatter:function(e){return Math.round(e/100)}}),Object(w.jsx)(G.a,{domain:["dataMin","dataMax"],hide:!0})]})})})},I=a(89),L=a(42),S=a(173),R=a(23),J=a.n(R),K=a(91),V=function(e){var t=e.color,a=e.index,n=Object(S.a)(e,["color","index"]),r={borderColor:t};return Object(w.jsx)("input",Object(L.a)({index:a,className:J.a.input,style:r},n))},Y=function(e){var t=e.index,a=e.track,n=e.setTrack,r=a.formula,c=a.noteDuration,s=function(e){return function(t){a[e]=t.target.value,n(a)}};return Object(w.jsxs)("div",{className:J.a.editable,children:[Object(w.jsx)("label",{className:J.a.label,children:"Formula"}),Object(w.jsx)(V,{color:a.color,index:t,value:r,onChange:s("formula")}),Object(w.jsx)("label",{className:J.a.label,children:"Note duration (ms)"}),Object(w.jsx)(V,{color:a.color,index:t,value:c,onChange:s("noteDuration"),type:"number"})]})},q=function(e){var t=e.isCollapsed,a=e.index,n=e.track,r=e.tracks,c=e.setTrack,s=e.setTracks;if(t)return null;var o=[J.a.icon];n.isMuted&&o.push(J.a.isMuted);var i=n.isMuted?K.c:K.b;return Object(w.jsxs)("div",{className:J.a.icons,children:[Object(w.jsx)("div",{onClick:function(){c(Object(L.a)(Object(L.a)({},n),{},{isMuted:!n.isMuted}))},className:o.join(" "),children:Object(w.jsx)(i,{className:J.a.muteIcon})}),Object(w.jsx)("div",{onClick:function(){1!==r.length&&(r.splice(a,1),s(Object(I.a)(r)))},className:J.a.icon,children:Object(w.jsx)(K.a,{className:J.a.trashIcon})})]})},z=function(e){var t=e.index,a=e.track,r=e.tracks,c=e.setTracks,s=e.setTrack,i=Object(n.useState)(0!==t),l=Object(o.a)(i,2),u=l[0],b=l[1],d=a.color,j={borderColor:d,backgroundColor:d+k},m=[J.a.container];u&&m.push(J.a.collapsed);return Object(w.jsxs)("div",{style:j,className:m.join(" "),children:[Object(w.jsxs)("div",{className:J.a.header,children:[Object(w.jsxs)("div",{onClick:function(e){b(!u)},className:J.a.title,children:["Track ",t+1]}),Object(w.jsx)(q,{index:t,isCollapsed:u,track:a,tracks:r,setTrack:s,setTracks:c})]}),u?null:Object(w.jsx)(Y,{track:a,index:t,setTrack:s})]})},U=a(73),W=a.n(U),Q=function(e){var t={borderColor:B};return Object(w.jsxs)("div",{className:W.a.inputGroup,children:[Object(w.jsx)("label",{className:W.a.label,children:e.label}),Object(w.jsx)("input",Object(L.a)({className:W.a.input,style:t},e))]})},X=function(e){var t=e.bpm,a=e.numBeats,n=e.noteRange,r=e.setBpm,c=e.setNumBeats,s=e.setNoteRange,o={backgroundColor:"#666666cc",borderColor:B};return Object(w.jsxs)("div",{className:W.a.container,style:o,children:[Object(w.jsx)(Q,{label:"Tempo (bpm)",type:"number",value:t,onChange:function(e){return r(Number(e.target.value))}}),Object(w.jsx)(Q,{label:"Beats per measure",type:"number",value:a,onChange:function(e){return c(Number(e.target.value))}}),Object(w.jsx)(Q,{label:"Note range",type:"number",value:n,onChange:function(e){return s(Number(e.target.value))}}),Object(w.jsx)(Q,{label:"Low note",value:"D3",onChange:function(){return null},disabled:!0}),Object(w.jsx)(Q,{label:"Scale",value:"D Major",onChange:function(){return null},disabled:!0})]})},Z=a(74),H=a.n(Z),$=function(){return Object(w.jsxs)("div",{className:H.a.container,children:[Object(w.jsx)("div",{className:H.a.text,children:"SCALER"}),Object(w.jsx)("div",{className:H.a.line}),Object(w.jsx)("a",{className:H.a.link,href:"https://github.com/alexcrist/scaler",target:"_",children:"see the code"})]})},ee=a(170),te=a.n(ee),ae=function(e){var t=e.isPlaying,a=e.bpm,n=e.numBeats,r=Math.round(n/a*60*1e3),c=t?{animationDuration:"".concat(r,"ms")}:{animation:"none",display:"none"};return Object(w.jsx)("div",{className:te.a.arm,style:c})},ne=a(75),re=a.n(ne),ce=function(e){var t=e.numBeats,a=e.track,n=e.setTrack;if(!a)return null;for(var r=a.color,c={backgroundColor:r+k,borderColor:r},s=[],o=function(e){var t=[re.a.button];a.disabledBeats.includes(e)&&t.push(re.a.disabled),s.push(Object(w.jsx)("div",{onClick:function(){for(var t=!0,r=0;r<a.disabledBeats.length;r++)e===a.disabledBeats[r]&&(a.disabledBeats.splice(r,1),t=!1);t&&a.disabledBeats.push(e),n(Object(L.a)({},a))},style:c,className:t.join(" ")},e))},i=0;i<t;i++)o(i);var l=[re.a.buttons];return a.isMuted&&l.push(re.a.muted),Object(w.jsx)("div",{className:l.join(" "),children:s})},se=a(114),oe=a.n(se),ie=function(e){var t=e.tracks,a=e.setTracks;return Object(w.jsx)("div",{onClick:function(){var e=t[t.length-1].color,n=(v.indexOf(e)+1)%v.length,r={color:v[n],formula:"y = 0",noteDuration:100,disabledBeats:[],isMuted:!1};a([].concat(Object(I.a)(t),[r]))},className:oe.a.createTrack,style:{borderColor:B,backgroundColor:"#666666cc"},children:Object(w.jsx)("div",{className:oe.a.createTrackText,children:"Add track"})})},le=a(115),ue=a.n(le),be=function(e){var t=e.isPlaying,a=e.setIsPlaying,n=t?"Stop":"Play",r=t?{borderColor:"#980031",backgroundColor:"#98003199"}:{borderColor:"#489900",backgroundColor:"#48990099"};return Object(w.jsx)("div",{onClick:function(){a(!t)},className:ue.a.play,style:r,children:Object(w.jsx)("div",{className:ue.a.playText,children:n})})},de=h[2],je=function(){var e=Object(n.useState)([]),t=Object(o.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(120),s=Object(o.a)(c,2),i=s[0],u=s[1],b=Object(n.useState)(8),j=Object(o.a)(b,2),m=j[0],p=j[1],f=Object(n.useState)(14),h=Object(o.a)(f,2),_=h[0],O=h[1],v=Object(n.useState)(!1),k=Object(o.a)(v,2),B=k[0],y=k[1],C=Object(n.useMemo)((function(){return function(e,t,a,n,r){for(var c=n.notes.indexOf(r),s=[],o=0;o<t;o++)s.push(o/t*2*Math.PI);var i=e.map((function(e){var t=e.formula;try{return d(t,s)}catch(a){return[]}})),u=l()(i).flatten().min(),b=l()(i).flatten().max();return i.map((function(e){return e.map((function(e){return Math.round((e-u)/(b-u||1)*(a-1))})).map((function(e){return n.notes[e+c]}))}))}(a,m,_,de,"D3")}),[a,m,_]),A=Object(n.useRef)({tracks:a,bpm:i,notes:C,numBeats:m,isPlaying:B});Object(n.useEffect)((function(){A.current={tracks:a,bpm:i,notes:C,numBeats:m,isPlaying:B}}),[a,i,C,m,B]),Object(n.useEffect)((function(){r(g())}),[]),Object(n.useEffect)((function(){B&&x(A)}),[B]);var N=function(e){return function(t){var n=l.a.cloneDeep(a);n[e]=t,r(n)}};return Object(w.jsxs)("div",{className:T.a.app,children:[Object(w.jsx)($,{}),Object(w.jsxs)("div",{className:T.a.row,children:[Object(w.jsxs)("div",{className:T.a.left,children:[Object(w.jsxs)("div",{className:T.a.chart,children:[Object(w.jsx)(P,{tracks:a,numBeats:m,notes:C}),Object(w.jsx)(ae,{isPlaying:B,bpm:i,numBeats:m})]}),a.map((function(e,t){return Object(w.jsx)(ce,{numBeats:m,track:e,setTrack:N(t)},t)}))]}),Object(w.jsxs)("div",{className:T.a.right,children:[Object(w.jsxs)("div",{className:T.a.buttons,children:[Object(w.jsx)(be,{isPlaying:B,setIsPlaying:y}),Object(w.jsx)(ie,{tracks:a,setTracks:r})]}),a.map((function(e,t){return Object(w.jsx)(z,{index:t,track:e,tracks:a,setTrack:N(t),setTracks:r},t)}))]})]}),Object(w.jsx)(X,{isPlaying:B,bpm:i,numBeats:m,noteRange:_,setIsPlaying:y,setBpm:u,setNumBeats:p,setNoteRange:O})]})};a(320);s.a.render(Object(w.jsx)(r.a.StrictMode,{children:Object(w.jsx)(je,{})}),document.getElementById("root"))},48:function(e,t,a){e.exports={app:"App_app__1IksY",row:"App_row__2IEL-",left:"App_left__1u-q5",chart:"App_chart__1PrK6",right:"App_right__3pQWj",buttons:"App_buttons__22Fcg"}},73:function(e,t,a){e.exports={container:"LoopOptions_container__1J57F",inputGroup:"LoopOptions_inputGroup__18R54",label:"LoopOptions_label__2B8FD",input:"LoopOptions_input__19Sav"}},74:function(e,t,a){e.exports={container:"Title_container__e3k5b",text:"Title_text__39Uar",link:"Title_link__2onV0",line:"Title_line__1RmyE"}},75:function(e,t,a){e.exports={buttons:"EnabledNotes_buttons__YuCJP",muted:"EnabledNotes_muted__2I7zC",button:"EnabledNotes_button__3316l",disabled:"EnabledNotes_disabled__1W2ff"}}},[[321,1,2]]]);
//# sourceMappingURL=main.7dde74a7.chunk.js.map