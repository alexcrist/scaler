{"version":3,"sources":["components/DropdownMenu/DropdownMenu.module.css","components/Load/Load.module.css","components/More/More.module.css","components/Play/Play.module.css","components/AddTrack/AddTrack.module.css","components/Chart/Chart.module.css","components/Save/Save.module.css","components/TimelineArm/TimelineArm.module.css","components/TrackOptions/TrackOptions.module.css","components/LoopOptions/LoopOptions.module.css","constants/notes.js","constants/scales.js","util/audioPlayer.js","util/formulaEvaluator.js","constants/colors.js","util/objectCompressor.js","util/storageManager.js","util/stateLoader.js","components/AddTrack/AddTrack.js","components/Chart/Chart.js","components/EnabledNotes/EnabledNotes.js","components/Header/Header.js","components/DropdownMenu/DropdownMenu.js","components/Load/Load.js","components/LoopOptions/LoopOptions.js","util/midiWriter.js","util/fileDownloader.js","util/sharer.js","components/More/More.js","components/Play/Play.js","components/Save/Save.js","components/TimelineArm/TimelineArm.js","components/TrackOptions/TrackOptions.js","components/App/App.js","util/noteCalculator.js","index.js","components/App/App.module.css","components/EnabledNotes/EnabledNotes.module.css","components/Header/Header.module.css"],"names":["module","exports","NOTES","FREQS","length","Error","NOTE_MAP","i","PITCHES","MODES","name","steps","getScalePitches","pitch","index","indexOf","scale","map","step","unshift","pop","scales","mode","scalePitches","scaleNotes","filter","note","notePitch","substring","includes","push","pitches","notes","audioId","SCALES","_","sortBy","o","NOTE_SHAPE","Float32Array","v","audioContext","window","AudioContext","webkitAudioContext","audioNodes","createAudioNodes","tracks","bpm","numBeats","secondsPerBeat","secondsPerLoop","audioLocation","getCurrentAudioLocation","startingBeatIndex","beatIndex","offsetTime","loopStartTime","currentTime","resetAudioNodes","numTracks","j","k","audioNode","buildAudioNode","localAudioId","generateId","waitTime","setTimeout","disconnectFutureNodes","Date","now","isValidPositveNumber","number","isNaN","loopIndex","track","freq","isTrackMuted","isMuted","isNoteMuted","disabledBeats","isActive","duration","noteDuration","startTime","isValid","volumeNode","oscillatorNode","createGain","connect","destination","gain","setValueCurveAtTime","createOscillator","frequency","setValueAtTime","start","stop","disconnect","formulaToData","formula","xValues","replace","yValues","x","y","evaluate","e","wasCapped","console","error","cap","COLORS","OPACITY_1","GRAY_1","toHash","stateObject","str","JSON","stringify","LZString","compressToEncodedURIComponent","fromHash","hash","decompressFromEncodedURIComponent","parse","LOCAL_SAVES_KEY","defaultData","noteRange","lowNote","color","loadInitialState","queryString","location","search","data","URLSearchParams","get","localStorage","getItem","loadRecent","AddTrack","setTracks","onClick","lastColor","newColorIndex","newTrack","className","styles","createTrack","style","borderColor","backgroundColor","createTrackText","Chart","numXValues","Math","PI","yValuesArray","xLines","ReferenceLine","strokeDasharray","yLines","yMin","floor","flatten","min","yMax","ceil","max","range","inc","log10","container","ResponsiveContainer","width","height","LineChart","Line","type","dataKey","stroke","opacity","dot","strokeWidth","Tooltip","formatter","__","properties","payload","trackIndex","Number","round","labelFormatter","label","YAxis","domain","hide","EnabledNotes","setTrack","buttonStyle","buttons","buttonClasses","button","disabled","wasEnabled","splice","join","buttonsClasses","muted","Header","text","line","link","href","target","DropdownMenu","containerRef","isVisible","setIsVisible","options","useEffect","handleClickOutside","current","contains","document","addEventListener","removeEventListener","dropdownClasses","dropdown","hidden","onClickOption","option","Load","setBpm","setNumBeats","setNoteRange","setScale","setLowNote","useRef","useState","setOptions","ref","title","newOptions","saves","savesArray","Object","keys","date","reverse","value","loadLocalSaves","save","load","icon","Input","props","inputStyle","inputGroup","input","ScaleSelect","split","modeNames","m","pitchIndex","modeIndex","updateScale","newPitch","newMode","scaleName","newScale","s","log","lowNoteIndex","newLowNote","scaleInputGroup","scaleSelects","onChange","modeName","LowNoteSelect","selectedIndex","newNote","LoopOptions","downloadMidi","filename","textContent","element","createElement","setAttribute","display","body","appendChild","click","removeChild","downloadFile","toMidiString","msPerBeat","midiTracks","midiTrack","MidiWriter","Track","setTempo","isDisabled","startMs","maxNoteDuration","Infinity","midiNote","NoteEvent","msToTicks","startTick","addEvent","Writer","dataUri","ms","tempo","seconds","shareUrl","saveData","a","url","origin","pathname","navigator","clipboard","writeText","alert","prompt","More","moreRef","moreContainer","more","moreIcon","Play","isPlaying","setIsPlaying","playStyle","play","playText","playIcon","Save","confirm","setItem","saveLocal","saveIcon","TimelineArm","armRef","periodDuration","gsap","fromTo","left","ease","repeat","pauseAnimation","arm","isError","classes","inputError","Inputs","isFormulaValid","createAttributeSetter","attribute","editable","Icons","isCollapsed","muteClasses","MuteIcon","FaVolumeMute","FaVolumeDown","icons","muteIcon","trashIcon","TrackOptions","setIsCollapsed","containerStyle","containerClasses","collapsed","header","App","useMemo","minNoteIndex","calculateNotes","history","pushState","storeRecent","createSetTrack","newTracks","cloneDeep","app","row","chart","right","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.02762c33.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"dropdown\":\"DropdownMenu_dropdown__2qjGn\",\"hidden\":\"DropdownMenu_hidden__OkTpS\",\"option\":\"DropdownMenu_option__1Eb3B\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"Load_container__2xm-W\",\"load\":\"Load_load__176E_\",\"icon\":\"Load_icon__1G4ds\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"moreContainer\":\"More_moreContainer__3myel\",\"more\":\"More_more__2Crn9\",\"moreIcon\":\"More_moreIcon__l1fRm\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"play\":\"Play_play__2x_Gd\",\"playIcon\":\"Play_playIcon__IwdyU\",\"playText\":\"Play_playText__1skLF\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"createTrack\":\"AddTrack_createTrack__1dZTK\",\"createTrackText\":\"AddTrack_createTrackText__3wNni\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"Chart_container__1PIOn\",\"cap\":\"Chart_cap__21rfP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"save\":\"Save_save__3A0OR\",\"saveIcon\":\"Save_saveIcon__2J_5P\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"arm\":\"TimelineArm_arm__2cLiz\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"TrackOptions_container__2E_dx\",\"collapsed\":\"TrackOptions_collapsed__X5vja\",\"header\":\"TrackOptions_header__3Lfwo\",\"icons\":\"TrackOptions_icons__33YYK\",\"icon\":\"TrackOptions_icon__3jQrz\",\"isMuted\":\"TrackOptions_isMuted__4aVJB\",\"muteIcon\":\"TrackOptions_muteIcon__175TR\",\"trashIcon\":\"TrackOptions_trashIcon__30wpV\",\"title\":\"TrackOptions_title__1ue4w\",\"label\":\"TrackOptions_label__1sLEb\",\"input\":\"TrackOptions_input__3reUO\",\"inputError\":\"TrackOptions_inputError__L1BNH\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"LoopOptions_container__1J57F\",\"inputGroup\":\"LoopOptions_inputGroup__18R54\",\"label\":\"LoopOptions_label__2B8FD\",\"input\":\"LoopOptions_input__19Sav\",\"scaleInputGroup\":\"LoopOptions_scaleInputGroup__3-xi8\",\"scaleSelects\":\"LoopOptions_scaleSelects__2-VIS\"};","export const NOTES = [ \n  'C0',  'Db0', 'D0', 'Eb0', 'E0', 'F0', 'Gb0', 'G0', 'Ab0', 'A0', 'Bb0', 'B0',\n  'C1',  'Db1', 'D1', 'Eb1', 'E1', 'F1', 'Gb1', 'G1', 'Ab1', 'A1', 'Bb1', 'B1',\n  'C2',  'Db2', 'D2', 'Eb2', 'E2', 'F2', 'Gb2', 'G2', 'Ab2', 'A2', 'Bb2', 'B2',\n  'C3',  'Db3', 'D3', 'Eb3', 'E3', 'F3', 'Gb3', 'G3', 'Ab3', 'A3', 'Bb3', 'B3',\n  'C4',  'Db4', 'D4', 'Eb4', 'E4', 'F4', 'Gb4', 'G4', 'Ab4', 'A4', 'Bb4', 'B4',\n  'C5',  'Db5', 'D5', 'Eb5', 'E5', 'F5', 'Gb5', 'G5', 'Ab5', 'A5', 'Bb5', 'B5',\n  'C6',  'Db6', 'D6', 'Eb6', 'E6', 'F6', 'Gb6', 'G6', 'Ab6', 'A6', 'Bb6', 'B6',\n  'C7',  'Db7', 'D7', 'Eb7', 'E7', 'F7', 'Gb7', 'G7', 'Ab7', 'A7', 'Bb7', 'B7',\n  'C8',  'Db8', 'D8', 'Eb8', 'E8', 'F8', 'Gb8', 'G8', 'Ab8', 'A8', 'Bb8', 'B8'\n];\n\nexport const FREQS = [\n  16.35, 17.32, 18.35, 19.45, 20.60, 21.83, 23.12, 24.50, 25.96, 27.50, 29.14, \n  30.87, 32.70, 34.65, 36.71, 38.89, 41.20, 43.65, 46.25, 49.00, 51.91, 55.00, \n  58.27, 61.74, 65.41, 69.30, 73.42, 77.78, 82.41, 87.31, 92.50, 98.00, 103.83, \n  110.00, 116.54, 123.47, 130.81, 138.59, 146.83, 155.56, 164.81, 174.61, 185.00, \n  196.00, 207.65, 220.00, 233.08, 246.94, 261.63, 277.18, 293.66, 311.13, 329.63, \n  349.23, 369.99, 392.00, 415.30, 440.00, 466.16, 493.88, 523.25, 554.37, 587.33, \n  622.25, 659.25, 698.46, 739.99, 783.99, 830.61, 880.00, 932.33, 987.77, 1046.50,\n  1108.73, 1174.66, 1244.51, 1318.51, 1396.91, 1479.98, 1567.98, 1661.22, 1760.00, \n  1864.66, 1975.53, 2093.00, 2217.46, 2349.32, 2489.02, 2637.02, 2793.83, 2959.96, \n  3135.96, 3322.44, 3520.00, 3729.31, 3951.07, 4186.01, 4434.92, 4698.63, 4978.03, \n  5274.04, 5587.65, 5919.91, 6271.93, 6644.88, 7040.00, 7458.62, 7902.13\n];\n\nif (NOTES.length !== FREQS.length) {\n  throw Error('# notes !== # freqs');\n}\n\nexport const NOTE_MAP = {};\nfor (let i = 0; i < NOTES.length; i++) {\n  NOTE_MAP[NOTES[i]] = FREQS[i];\n}\n\n\n\n","import _ from 'lodash';\nimport { NOTES } from \"./notes\";\n\nexport const PITCHES = [\n  'C',  'Db', 'D',  'Eb',\n  'E',  'F',  'Gb', 'G',\n  'Ab', 'A',  'Bb', 'B'\n];\n\nexport const MODES = [\n  {\n    name: 'Major',\n    steps: [2, 2, 1, 2, 2, 2, 1]\n  },\n  {\n    name: 'Minor',\n    steps: [2, 1, 2, 2, 1, 2, 2]\n  },\n  {\n    name: 'Major (pentatonic)',\n    steps: [2, 2, 3, 2, 3]\n  },\n  {\n    name: 'Minor (pentatonic)',\n    steps: [3, 2, 2, 3, 2]\n  }\n];\n\nconst getScalePitches = (pitch, steps) => {\n  let index = PITCHES.indexOf(pitch);\n  const scale = steps.map((step) => {\n    index = (index + step) % PITCHES.length;\n    return PITCHES[index];\n  });\n  scale.unshift(scale.pop());\n  return scale;\n};\n\nlet scales = [];\nfor (const pitch of PITCHES) {\n  for (const mode of MODES) {\n    const scalePitches = getScalePitches(pitch, mode.steps);\n    const scaleNotes = NOTES.filter((note) => {\n      const notePitch = note.substring(0, note.length - 1);\n      return scalePitches.includes(notePitch);\n    })\n    scales.push({\n      name: `${pitch} ${mode.name}`,\n      pitches: scalePitches,\n      notes: scaleNotes\n    })\n  }\n}\n\nscales = _.sortBy(scales, [\n  (o) => o.name.includes('pentatonic') ? 1 : 0,\n  (o) => PITCHES.indexOf(o.pitches[0])\n]);\n\nexport const SCALES = scales;\n","import { NOTE_MAP } from '../constants/notes';\n\nconst NUM_LOOPS_TO_QUEUE = 4;\nconst NOTE_SHAPE = new Float32Array([0, 0.8, 1, 0.3, 0].map(v => v * 0.05));\nconst AudioContext = (window.AudioContext || window.webkitAudioContext);\nconst audioContext = new AudioContext();\n\nlet audioId;\nlet audioNodes = [];\n/*\n  Structure of 'audioNodes':\n  [\n    {\n      beatIndex:      number,\n      startTime:      number,\n      volumeNode:     GainNode,\n      oscillatorNode: OscillatorNode\n    }\n  ]\n*/\n\n// Creating audio nodes (i.e.: starting audio playback) ========================\n\nexport const createAudioNodes = (\n  tracks,\n  notes,\n  bpm,\n  numBeats\n) => {\n  const secondsPerBeat = (1 / (bpm * 4)) * 60;\n  const secondsPerLoop = secondsPerBeat * numBeats;\n\n  // Point at which to recreate audio nodes\n  const audioLocation = getCurrentAudioLocation();\n  const startingBeatIndex = audioLocation.beatIndex;\n  const offsetTime = audioLocation.offsetTime;\n  const loopStartTime = audioContext.currentTime + offsetTime - (secondsPerBeat * startingBeatIndex);\n\n  // Purge existing audio nodes\n  resetAudioNodes();\n\n  // Build audio nodes\n  const numTracks = tracks.length;\n  for (let i = 0; i < NUM_LOOPS_TO_QUEUE; i++) {\n    for (let j = 0; j < numTracks; j++) {\n      for (let k = 0; k < numBeats; k++) {\n        if (i === 0 && k < startingBeatIndex) {\n          continue;\n        }\n        const audioNode = buildAudioNode(\n          i,\n          k,\n          notes[j][k],\n          tracks[j],\n          loopStartTime,\n          secondsPerBeat,\n          secondsPerLoop\n        );\n        audioNodes.push(audioNode);\n      }\n    }\n  }\n\n  // Create an ID unique to this update\n  const localAudioId = generateId();\n  audioId = localAudioId;\n\n  // Repeat\n  const waitTime = (audioNodes.length / numTracks * secondsPerBeat + offsetTime) * 1000;\n  setTimeout(() => {\n    if (audioId === localAudioId) {\n      createAudioNodes(\n        tracks, \n        notes,\n        bpm,\n        numBeats \n      );\n    }\n  }, waitTime);\n};\n\n// Resetting audio nodes (i.e.: stopping audio playback) =======================\n\nexport const resetAudioNodes = () => {\n  disconnectFutureNodes();\n  audioNodes = [];\n  audioId = null;\n};\n\n// Helper functions ============================================================\n\nconst generateId = () => Date.now();\n\nconst isValidPositveNumber = (number) => {\n  return (\n    typeof number === 'number' &&\n    !isNaN(number) &&\n    number > 0\n  );\n}\n\nconst buildAudioNode = (\n  loopIndex,\n  beatIndex,\n  note,\n  track,\n  loopStartTime,\n  secondsPerBeat,\n  secondsPerLoop\n) => {\n  const freq = NOTE_MAP[note];\n  const isTrackMuted = track.isMuted;\n  const isNoteMuted = track.disabledBeats.includes(beatIndex);\n  const isActive = !(isTrackMuted || isNoteMuted);\n  const duration = track.noteDuration / 1000;\n  const startTime = loopStartTime + (loopIndex * secondsPerLoop) + (beatIndex * secondsPerBeat);\n  const isValid = isValidPositveNumber(freq) && isValidPositveNumber(duration);\n  let volumeNode = null;\n  let oscillatorNode = null;\n  if (isActive && isValid) {\n    volumeNode = audioContext.createGain();\n    volumeNode.connect(audioContext.destination);\n    volumeNode.gain.setValueCurveAtTime(NOTE_SHAPE, startTime, duration);\n    oscillatorNode = audioContext.createOscillator();\n    oscillatorNode.connect(volumeNode);\n    oscillatorNode.frequency.setValueAtTime(freq, 0);\n    oscillatorNode.start(startTime);\n    oscillatorNode.stop(startTime + duration);\n  }\n  return {\n    beatIndex,\n    startTime,\n    volumeNode,\n    oscillatorNode\n  };\n};\n\nconst getCurrentAudioLocation = () => {\n  const { currentTime } = audioContext;\n  for (const audioNode of audioNodes) {\n    const { startTime, beatIndex } = audioNode;\n    if (startTime > currentTime) {\n      const offsetTime = startTime - currentTime;\n      return { beatIndex, offsetTime };\n    }\n  }\n  return { beatIndex: 0, offsetTime: 0 };\n};\n\nconst disconnectFutureNodes = () => {\n  const { currentTime } = audioContext;\n  for (const audioNode of audioNodes) {\n    const { startTime, volumeNode } = audioNode;\n    if (startTime > currentTime) {\n      if (volumeNode) {\n        volumeNode.disconnect();\n      }\n    }\n  }\n};\n","import { evaluate } from 'mathjs';\n\nexport const formulaToData = (formula, xValues) => {\n\n  // Validate formula\n  formula = formula.replace(/\\s+/g, '');\n  if (formula.substring(0,  2) !== 'y=') {\n    throw Error('Invalid formula: ' + formula);\n  }\n  formula = formula.substring(2);\n\n  // Calculate y-values\n  let yValues = [];\n  for (const x of xValues) {\n    try {\n      const y = evaluate(formula, { x });\n      yValues.push(y);\n    } catch (e) {\n      throw Error('Formula evaluation error: ' + formula);\n    }\n  }\n\n  // Cap big / small numbers\n  const cap = 30;\n  let wasCapped = false;\n  yValues = yValues.map((y) => {\n    if (y > cap) {\n      wasCapped = true;\n      return cap;\n    } else if (y < -cap) {\n      wasCapped = true;\n      return -cap;\n    }\n    return y;\n  });\n\n  // Handle bad values (functions)\n  for (const y of yValues)  {\n    if (typeof y !== 'number') {\n      console.error('Error in y-values:', yValues);\n      throw Error('Formula produced invalid values: ' + formula);\n    }\n  }\n\n  // Convert NaN to 0\n  yValues = yValues.map((y) => isNaN(y) ? 0 : y);\n\n  return {\n    yValues,\n    wasCapped,\n    cap\n  };\n};\n","export const COLOR_1 = '#8338ec';\nexport const COLOR_2 = '#ff006e';\nexport const COLOR_3 = '#3a86ff';\nexport const COLOR_4 = '#fb5607';\nexport const COLOR_5 = '#ffbe0b';\n\nexport const COLORS = [\n  COLOR_1,\n  COLOR_2,\n  COLOR_3,\n  COLOR_4,\n  COLOR_5\n];\n\nexport const OPACITY_1 = 'cc';\nexport const OPACITY_2 = '66';\nexport const OPACITY_3 = '11';\n\nexport const GRAY_1 = '#666666';","import LZString from 'lz-string';\n\nexport const toHash = (stateObject) => {\n  const str = JSON.stringify(stateObject);\n  return LZString.compressToEncodedURIComponent(str);\n};\n\nexport const fromHash = (hash) => {\n  const str = LZString.decompressFromEncodedURIComponent(hash);\n  return JSON.parse(str);\n};","import _ from 'lodash';\nimport { fromHash, toHash } from './objectCompressor';\n\nconst RECENT_KEY = 'd';\nconst LOCAL_SAVES_KEY = 'saves';\n\n// Load / save the user's current work =========================================\n\nexport const loadRecent = () => {\n  const hash = localStorage.getItem(RECENT_KEY);\n  if (hash === null) {\n    return null;\n  }\n  return fromHash(hash);\n};\n\nexport const storeRecent = (data) => {\n  const hash = toHash(data);\n  localStorage.setItem(RECENT_KEY, hash);\n};\n\n// Load / save the user's explicitly saved work ================================\n\nexport const loadLocalSaves = () => {\n  let saves = localStorage.getItem(LOCAL_SAVES_KEY);\n  if (saves === null) {\n    return [];\n  } else {\n    saves = fromHash(saves);\n  }\n\n  const savesArray = [];\n  for (const name of Object.keys(saves)) {\n    const { data, date } = saves[name];\n    savesArray.push({\n      name,\n      data,\n      date\n    });\n  }\n\n  return _(savesArray)\n    .sortBy('date')\n    .reverse()\n    .value();\n};\n\nexport const saveLocal = (data) => {\n  let saves = localStorage.getItem(LOCAL_SAVES_KEY);\n  if (saves === null) {\n    saves = {};\n  } else {\n    saves = fromHash(saves);\n  }\n\n  const name = prompt('Save as:')\n  if (name === null) {\n    return;\n  }\n  if (name === '') {\n    alert('Invalid name.');\n    return;\n  }\n\n  const previous = saves[name];\n  if (previous) {\n    const shouldOverwrite = window.confirm(`Overwrite previous \"${name}\"?`);\n    if (!shouldOverwrite) {\n      return;\n    }\n  }\n\n  saves[name] = {\n    data,\n    date: Date.now()\n  };\n\n  localStorage.setItem(LOCAL_SAVES_KEY, toHash(saves));\n};\n","import { COLORS } from '../constants/colors';\nimport { SCALES } from '../constants/scales';\nimport { fromHash } from './objectCompressor';\nimport { loadRecent } from './storageManager';\n\nconst defaultData = {\n  bpm: 60,\n  numBeats: 16,\n  noteRange: 14,\n  scale: SCALES[3],\n  lowNote: 'E3',\n  tracks: [\n    {\n      color: COLORS[0],\n      formula: 'y = min(sin(x), cos(x))',\n      noteDuration: 20,\n      disabledBeats: [1, 4, 7, 9, 10, 15],\n      isMuted: false\n    },\n    {\n      color: COLORS[1],\n      formula: 'y = (1 / (x + 0.5)) * cos(4x) - 2',\n      noteDuration: 90,\n      disabledBeats: [0, 2, 5, 6, 10, 12, 13],\n      isMuted: false\n    },\n    {\n      color: COLORS[2],\n      formula: 'y = 0',\n      noteDuration: 60,\n      disabledBeats: [0, 6, 9, 13],\n      isMuted: false\n    },\n  ]\n};\n\nexport const loadInitialState = () => {\n  const queryString = window.location.search;\n  const urlParams = new URLSearchParams(queryString);\n  let data = urlParams.get('d');\n  if (data) {\n    return fromHash(data);\n  }\n  data = loadRecent();\n  if (data) {\n    return data;\n  }\n  return defaultData;\n};\n","import { COLORS, GRAY_1, OPACITY_1 } from '../../constants/colors';\nimport styles from './AddTrack.module.css';\n\nconst AddTrack = ({ tracks, setTracks }) => {\n\n  const addTrack = () => {\n    const lastColor = tracks[tracks.length - 1].color;\n    const lastColorIndex = COLORS.indexOf(lastColor);\n    const newColorIndex = (lastColorIndex + 1) % COLORS.length;\n    const newColor = COLORS[newColorIndex];\n    const newTrack = {\n      color: newColor,\n      formula: 'y = 0',\n      noteDuration: 100,\n      disabledBeats: [],\n      isMuted: false\n    };\n    setTracks([...tracks, newTrack]);\n  };\n\n  return (\n    <div\n      onClick={addTrack}\n      className={styles.createTrack}\n      style={{\n        borderColor: GRAY_1,\n        backgroundColor: GRAY_1 + OPACITY_1,\n      }}\n    >\n      <div className={styles.createTrackText} />\n    </div>\n  );\n};\n\nexport default AddTrack;","import _ from 'lodash';\nimport { Line, LineChart, ReferenceLine, ResponsiveContainer, Tooltip, YAxis } from 'recharts';\nimport { formulaToData } from '../../util/formulaEvaluator';\nimport styles from './Chart.module.css';\n\nconst H = 300;\nconst dataResolution = 20; \n\nconst Chart = ({\n  tracks,\n  numBeats,\n  notes,\n}) => {\n\n  const xValues = [];\n  const numXValues = numBeats * dataResolution;\n  for (let i = 0; i < numXValues + 1; i++) {\n    xValues.push(i * (2 * Math.PI) / numXValues);\n  }\n\n  let wasCapped = false;\n  let cap = 0;\n  const yValuesArray = tracks\n    .map((track) => {\n      try {\n        const data = formulaToData(track.formula, xValues);\n        wasCapped = wasCapped || data.wasCapped;\n        cap = data.cap;\n        return data.yValues;\n      } catch (e) {\n        return [];\n      }\n    });\n\n  const data = xValues.map((x, i) => ({ x, i }));\n\n  for (let i = 0; i < yValuesArray.length; i++) {\n    const name = `Track ${i + 1}`;\n    const yValues = yValuesArray[i];\n    for (let j = 0; j < yValues.length; j++) {\n      const y = yValues[j];\n      data[j][name] = y;\n    }\n  }\n\n  const xLines = [];\n  for (let i = 0; i < numBeats + 1; i++) {\n    xLines.push(\n      <ReferenceLine\n        key={`x-line-${i}`}\n        x={i / numBeats * numXValues}\n        strokeDasharray='3 3'\n      />\n    );\n  }\n\n  const yLines = [];\n  const yMin = Math.floor(_(yValuesArray).flatten().min());\n  const yMax = Math.ceil(_(yValuesArray).flatten().max());\n  const range = yMax - yMin;\n  const inc = Math.max(1, 10 ** Math.floor(Math.log10(range - 1)));\n  for (let i = yMin; i <= yMax; i += inc) {\n    yLines.push(\n      <ReferenceLine\n        key={`y-line-${i}`}\n        y={i}\n        strokeDasharray='3 3'\n      />\n    );\n  }\n\n  const formatter = (_, __,  properties) => {\n    const { dataKey, payload: { i } } = properties; \n    const trackIndex = Number(dataKey[dataKey.length - 1]) - 1;\n    const beatIndex = Math.round(i / dataResolution);\n    return notes[trackIndex][beatIndex];\n  };\n\n  return (\n    <div className={styles.container}>\n      <ResponsiveContainer width='100%' height={H}>\n        <LineChart\n          data={data}\n        >\n          {xLines}\n          {yLines}\n          {tracks.map((track, i) => (\n            <Line\n              key={`line-${i}`}\n              type='monotone'\n              dataKey={`Track ${i + 1}`}\n              stroke={track.color}\n              opacity={track.isMuted ? 0.4 : 1}\n              dot={false}\n              strokeWidth={2}\n            />\n          ))}\n          <Tooltip\n            formatter={formatter}\n            labelFormatter={(label) => Math.floor(label / dataResolution) + 1}\n          />\n          <YAxis domain={['dataMin', 'dataMax']} hide={true} />\n        </LineChart>\n      </ResponsiveContainer>\n      {wasCapped\n        ? <div className={styles.cap}>* y-values capped at Â±{cap}</div>\n        : null\n      }\n    </div>\n  );\n};\n\nexport default Chart;","import { OPACITY_1 } from '../../constants/colors';\nimport styles from './EnabledNotes.module.css';\n\nconst EnabledNotes = ({ numBeats, track, setTrack }) => {\n\n  if (!track) {\n    return null;\n  }\n\n  const { color } = track;\n  const buttonStyle = {\n    backgroundColor: color + OPACITY_1,\n    borderColor: color\n  };\n\n  const buttons = [];\n  for (let i = 0; i < numBeats; i++) {\n\n    const onClick = () => {\n      let wasEnabled = true;\n      for (let j = 0; j < track.disabledBeats.length; j++) {\n        if (i === track.disabledBeats[j]) {\n          track.disabledBeats.splice(j, 1);\n          wasEnabled = false;\n        }\n      }\n      if (wasEnabled) {\n        track.disabledBeats.push(i);\n      }\n      setTrack({ ...track });\n    };\n\n    const buttonClasses = [styles.button];\n    if (track.disabledBeats.includes(i)) {\n      buttonClasses.push(styles.disabled);\n    }\n\n    buttons.push(\n      <div\n        key={i}\n        onClick={onClick}\n        style={buttonStyle}\n        className={buttonClasses.join(' ')}\n      >\n        {i + 1}\n      </div>\n    );\n  }\n\n  const buttonsClasses = [styles.buttons];\n  if (track.isMuted) {\n    buttonsClasses.push(styles.muted);\n  }\n\n  return (\n    <div className={buttonsClasses.join(' ')}>\n      {buttons}\n    </div>\n  )\n};\n\nexport default EnabledNotes;","import styles from './Header.module.css';\n\nconst Header = () => {\n  return (\n    <div className={styles.container}>\n      <div className={styles.text}>\n        SCALER\n      </div>\n      <div className={styles.line} />\n      <a \n        className={styles.link} \n        href='https://github.com/alexcrist/scaler'\n        target='_'  \n      >\n        see the code\n      </a>\n    </div>\n  );\n};\n\nexport default Header;","import { useEffect } from 'react';\nimport styles from './DropdownMenu.module.css';\n\nconst DropdownMenu = ({\n  containerRef,\n  isVisible,\n  setIsVisible, \n  options \n}) => {\n\n  // Close menu when user clicks somewhere else\n  useEffect(() => {\n    const handleClickOutside = (e) => {\n      if (containerRef.current && !containerRef.current.contains(e.target)) {\n        setIsVisible(false);\n      }\n    };\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [containerRef, setIsVisible]);\n\n  const dropdownClasses = [styles.dropdown];\n  if (!isVisible) {\n    dropdownClasses.push(styles.hidden);\n  }\n\n  const onClickOption = (option) => () => {\n    setIsVisible(false);\n    option.onClick();\n  };\n\n  return (\n    <div className={dropdownClasses.join(' ')}>\n      {options.map((option, index) => (\n        <div\n          key={index} \n          className={styles.option}\n          onClick={onClickOption(option)}\n        >\n          {option.label}\n        </div>\n      ))}\n    </div>\n  );\n};\n\nexport default DropdownMenu;","import { useState, useRef } from 'react';\nimport { FaFolder } from 'react-icons/fa';\nimport { GRAY_1, OPACITY_1 } from '../../constants/colors';\nimport { loadLocalSaves } from '../../util/storageManager';\nimport DropdownMenu from '../DropdownMenu/DropdownMenu';\nimport styles from './Load.module.css';\n\nconst Load = ({\n  setBpm,\n  setNumBeats,\n  setNoteRange,\n  setScale,\n  setLowNote,\n  setTracks\n}) => {\n\n  const containerRef = useRef(null);\n  const [isVisible, setIsVisible] = useState(false);\n  const [options, setOptions] = useState([]);\n\n  const onClickLoad = () => {\n    setIsVisible(!isVisible);\n    const saves = loadLocalSaves();\n    let newOptions = saves.map((save) => ({\n      label: save.name,\n      onClick: () => {\n        const {\n          bpm,\n          numBeats,\n          noteRange,\n          scale,\n          lowNote,\n          tracks\n        } = save.data;\n        setBpm(bpm);\n        setNumBeats(numBeats);\n        setNoteRange(noteRange);\n        setScale(scale);\n        setLowNote(lowNote);\n        setTracks(tracks);\n      }\n    }));\n\n    if (newOptions.length === 0) {\n      newOptions = [{\n        label: 'No saves',\n        onClick: () => {},\n      }]\n    }\n\n    setOptions(newOptions);\n  };\n\n  return (\n    <div\n      ref={containerRef}\n      className={styles.container}\n    >\n      <div \n        title='Load'\n        onClick={onClickLoad}\n        className={styles.load}\n        style={{\n          borderColor: GRAY_1,\n          backgroundColor: GRAY_1 + OPACITY_1,\n        }}\n      >\n        <div className={styles.icon}>\n          <FaFolder />\n        </div>\n      </div>\n\n      <DropdownMenu\n        containerRef={containerRef}\n        isVisible={isVisible}\n        setIsVisible={setIsVisible}\n        options={options}\n      />\n    </div>\n  )\n};\n\nexport default Load;","import { update } from 'lodash';\nimport { GRAY_1, OPACITY_1 } from '../../constants/colors';\nimport { MODES, PITCHES, SCALES } from '../../constants/scales';\nimport styles from './LoopOptions.module.css';\n\nconst Input = (props) => {\n  const inputStyle = { borderColor: GRAY_1 };\n  return (\n    <div className={styles.inputGroup}>\n      <label className={styles.label}>\n        {props.label}\n      </label>\n      <input\n        className={styles.input}\n        style={inputStyle}\n        {...props}\n      />\n    </div>\n  );\n};\n\nconst ScaleSelect = ({ scale, setScale, lowNote, setLowNote }) => {\n\n  const [pitch, ...modeArray] = scale.name.split(' ');\n  const mode = modeArray.join(' ');\n  const modeNames = MODES.map((m) => m.name);\n\n  const pitchIndex = PITCHES.indexOf(pitch);\n  const modeIndex = modeNames.indexOf(mode);\n\n  const updateScale = (newPitch, newMode) => {\n    const scaleName = `${newPitch} ${newMode}`;\n    const newScale = SCALES.filter((s) => s.name === scaleName)[0];\n    console.log(scaleName);\n    const lowNoteIndex = scale.notes.indexOf(lowNote);\n    const newLowNote = newScale.notes[lowNoteIndex];\n    setLowNote(newLowNote);\n    setScale(newScale);\n  }\n\n  const onChangePitch = (e) => updateScale(PITCHES[e.target.value], mode);\n\n  const onChangeMode = (e) => updateScale(pitch, modeNames[e.target.value]);\n\n  return (\n    <div className={`${styles.inputGroup} ${styles.scaleInputGroup}`}>\n      <label className={styles.label}>\n        Scale\n      </label>\n      <div className={styles.scaleSelects}>\n        <select\n          style={{ borderColor: GRAY_1 }}\n          className={styles.input}\n          onChange={onChangePitch}\n          value={pitchIndex}\n        >\n          {PITCHES.map((pitch, index) => (\n            <option\n              key={index}\n              value={index}\n            >\n              {pitch}\n            </option>\n          ))}\n        </select>\n        <select\n          style={{ borderColor: GRAY_1 }}\n          className={styles.input}\n          onChange={onChangeMode}\n          value={modeIndex}\n        >\n          {modeNames.map((modeName, index) => (\n            <option\n              key={index}\n              value={index}\n            >\n              {modeName}\n            </option>\n          ))}\n        </select>\n      </div>\n    </div>\n  )\n};\n\nconst LowNoteSelect = ({ scale, lowNote, setLowNote }) => {\n\n  const selectedIndex = scale.notes.indexOf(lowNote);\n\n  const onChange = (e) => {\n    const newNote = scale.notes[e.target.value];\n    setLowNote(newNote);\n  };\n\n  return (\n    <div className={styles.inputGroup}>\n      <label className={styles.label}>\n        Low note\n      </label>\n      <select\n        style={{ borderColor: GRAY_1 }}\n        className={styles.input}\n        onChange={onChange}\n        value={selectedIndex}\n      >\n        {scale.notes.map((note, index) => (\n          <option\n            key={index}\n            value={index}\n          >\n            {note}\n          </option>\n        ))}\n      </select>\n    </div>\n  )\n};\n\nconst LoopOptions = ({\n  scale,\n  lowNote,\n  bpm,\n  numBeats,\n  noteRange,\n  setScale,\n  setLowNote,\n  setBpm,\n  setNumBeats,\n  setNoteRange\n}) => {\n\n  return (\n    <div\n      className={styles.container}\n      style={{ backgroundColor: GRAY_1 + OPACITY_1, borderColor: GRAY_1 }}\n    >\n      <Input\n        label='Tempo (bpm)'\n        type='number'\n        value={bpm}\n        onChange={(e) => setBpm(Math.min(Number(e.target.value), 999))}\n      />\n      <Input\n        label='Beats per measure'\n        type='number'\n        value={numBeats}\n        onChange={(e) => setNumBeats(Math.min(Number(e.target.value), 99))}\n      />\n      <Input\n        label='Pitch range'\n        type='number'\n        value={noteRange}\n        onChange={(e) => setNoteRange(Math.min(Number(e.target.value), 99))}\n      />\n      <LowNoteSelect\n        scale={scale}\n        lowNote={lowNote}\n        setLowNote={setLowNote}\n      />\n      <ScaleSelect\n        lowNote={lowNote}\n        setLowNote={setLowNote}\n        scale={scale}\n        setScale={setScale}\n      />\n    </div>\n  );\n};\n\nexport default LoopOptions;","import MidiWriter from 'midi-writer-js';\nimport { downloadFile } from './fileDownloader';\n\nexport const downloadMidi = ({ bpm, tracks, notes }) => {\n  const midiString = toMidiString({ bpm, tracks, notes });\n  downloadFile('scaler.mid', midiString);\n};\n\nconst toMidiString = ({ bpm, tracks, notes }) => {\n\n  // BPM times four to represent quarter notes\n  const msPerBeat = (1 / (bpm * 4)) * 60 * 1000;\n\n  const midiTracks = [];\n\n  for (let i = 0; i < tracks.length; i++) {\n    const { noteDuration, disabledBeats } = tracks[i];\n    const midiTrack = new MidiWriter.Track();\n    midiTrack.setTempo(bpm);\n\n    for (let j = 0; j < notes[i].length; j++) {\n      const note = notes[i][j];\n      const isDisabled = disabledBeats.includes(j);\n      const startMs = j * msPerBeat;\n\n      // Don't allow a note's duration to exceed when the next same note begins\n      let maxNoteDuration = Infinity;\n      for (let k = j + 1; k < notes[i].length; k++) {\n        const nextNote = notes[i][k];\n        if (note === nextNote) {\n          const nextStartMs = k * msPerBeat;\n          maxNoteDuration = nextStartMs - startMs - 1;\n          break;\n        }\n      }\n\n      const duration = Math.min(noteDuration, maxNoteDuration);\n\n      if (!isDisabled) {\n        const midiNote = new MidiWriter.NoteEvent({\n          pitch: note,\n          duration: 'T' + msToTicks(duration, bpm),\n          startTick: msToTicks(startMs, bpm)\n        });\n        midiTrack.addEvent(midiNote);\n      }\n    }\n\n    midiTracks.push(midiTrack);\n  }\n\n  const writer = new MidiWriter.Writer(midiTracks);\n  const midiString = writer.dataUri();\n  return midiString;\n};\n\nconst msToTicks = (ms, bpm) => {\n  const tempo = Math.round((60 * 1000000) / bpm);\n  const ticksPerBeat = 128;\n  const seconds = ms / 1000;\n  const ticks = Math.round(seconds / (tempo * 1e-6 / ticksPerBeat));\n  return ticks;\n};","export const downloadFile = (filename, textContent) => {\n  const element = document.createElement('a');\n  element.setAttribute('href', textContent);\n  element.setAttribute('download', filename);\n  element.style.display = 'none';\n  document.body.appendChild(element);\n  element.click();\n  document.body.removeChild(element);\n};","import { toHash } from './objectCompressor';\n\nexport const shareUrl = async (saveData) => {\n  const hash = toHash(saveData);\n  const url = window.location.origin + window.location.pathname + '?d=' + hash;\n  try {\n    await navigator.clipboard.writeText(url);\n    alert('A link to your work has been copied to your clipboard.');\n  } catch (e) {\n    prompt('Save the following URL to access your work:', url);\n  }\n};","import { useRef, useState } from 'react';\nimport { FaEllipsisV } from 'react-icons/fa';\nimport { GRAY_1, OPACITY_1 } from '../../constants/colors';\nimport { downloadMidi } from '../../util/midiWriter';\nimport { shareUrl } from '../../util/sharer';\nimport DropdownMenu from '../DropdownMenu/DropdownMenu';\nimport styles from './More.module.css';\n\nconst More = ({ saveData, notes }) => {\n\n  const moreRef = useRef(null);\n  const [isVisible, setIsVisible] = useState(false);\n  const onClickMore = () => setIsVisible(!isVisible);\n\n  const options = [\n    {\n      onClick: () => shareUrl(saveData),\n      label: 'Share'\n    },\n    {\n      onClick: () => downloadMidi({ ...saveData, notes }),\n      label: 'Export to MIDI'\n    }\n  ];\n\n  return (\n    <div\n      ref={moreRef} \n      className={styles.moreContainer}\n    >\n      <div\n        title='More'\n        onClick={onClickMore}\n        className={styles.more}\n        style={{\n          borderColor: GRAY_1,\n          backgroundColor: GRAY_1 + OPACITY_1,\n        }}\n      >\n        <div className={styles.moreIcon}>\n          <FaEllipsisV />\n        </div>\n      </div>\n\n      <DropdownMenu\n        isVisible={isVisible}\n        setIsVisible={setIsVisible}\n        options={options}\n        containerRef={moreRef}\n      />\n    </div>\n  );\n};\n\nexport default More;","import { FaPlay, FaStop } from 'react-icons/fa';\nimport styles from './Play.module.css';\n\nconst Play = ({ isPlaying, setIsPlaying }) => {\n\n  const playStyle = isPlaying\n    ? {\n      borderColor: '#980031',\n      backgroundColor: '#98003199'\n    }\n    : {\n      borderColor: '#489900',\n      backgroundColor: '#48990099'\n    };\n\n  const onPlay = () => {\n    setIsPlaying(!isPlaying);\n  };\n\n  return (\n    <div\n      onClick={onPlay}\n      className={styles.play}\n      style={playStyle}\n    >\n      <div className={styles.playText}>\n        {isPlaying ? 'Stop' : 'Play'}\n      </div>\n      <div className={styles.playIcon}>\n        {isPlaying\n          ? <FaStop />\n          : <FaPlay />\n        }\n      </div>\n    </div>\n  );\n};\n\n\nexport default Play;","import { FaSave } from 'react-icons/fa';\nimport { GRAY_1, OPACITY_1 } from '../../constants/colors';\nimport { saveLocal } from '../../util/storageManager';\nimport styles from './Save.module.css';\n\nconst Save = ({ saveData }) => {\n\n  const onSave = () => {\n    saveLocal(saveData);\n  };\n\n  return (\n    <div\n      title='Save'\n      onClick={onSave}\n      className={styles.save}\n      style={{\n        borderColor: GRAY_1,\n        backgroundColor: GRAY_1 + OPACITY_1,\n      }}\n    >\n      <div className={styles.saveIcon}>\n        <FaSave />\n      </div>\n    </div>\n  );\n};\n\nexport default Save;\n","import { useEffect, useRef } from 'react';\nimport gsap from 'gsap';\nimport styles from './TimelineArm.module.css';\n\nconst playAnimation = (ref, duration) => {\n  gsap.fromTo(ref, {\n    left: 0,\n    opacity: 1\n  }, {\n    opacity: 1,\n    left: '100%',\n    ease: 'linear',\n    repeat: -1,\n    duration\n  });\n};\n\nconst pauseAnimation = (ref, duration) => {\n  gsap.fromTo(ref, {\n    left: 0,\n    opacity: 0\n  }, {\n    left: 0,\n    opacity: 0,\n    ease: 'linear',\n    repeat: -1,\n    duration\n  });\n};\n\nconst TimelineArm = ({\n  isPlaying,\n  numBeats,\n  bpm,\n}) => {\n  const armRef = useRef(null);\n\n  useEffect(() => {\n    // Multiply BPM times four to represent quarter notes\n    const periodDuration = numBeats / (bpm * 4) * 60;\n    if (isPlaying) {\n      playAnimation(armRef.current, periodDuration);\n    } else {\n      pauseAnimation(armRef.current, periodDuration);\n    }\n  }, [isPlaying, numBeats, bpm]);\n\n  return (\n    <div\n      ref={armRef}\n      className={styles.arm}\n    ></div>\n  );\n};\n\nexport default TimelineArm;","import { useState } from 'react';\nimport { FaTrash, FaVolumeDown, FaVolumeMute } from 'react-icons/fa';\nimport { OPACITY_1 } from '../../constants/colors';\nimport { formulaToData } from '../../util/formulaEvaluator';\nimport styles from './TrackOptions.module.css';\n\nconst Input = ({ color, index, isError, ...props }) => {\n  const borderColor = color;\n  const style = { borderColor };\n  const classes = [styles.input];\n  if (isError) {\n    classes.push(styles.inputError);\n  }\n  return (\n    <input\n      index={index}\n      className={classes.join(' ')}\n      style={style}\n      {...props}\n    />\n  );\n};\n\nconst Inputs = ({\n  index,\n  track,\n  setTrack\n}) => {\n\n  const { formula, noteDuration } = track;\n\n  let isFormulaValid = true;\n  try {\n    formulaToData(formula, [0, Math.PI]);\n  } catch (e) {\n    isFormulaValid = false;\n  }\n\n  const createAttributeSetter = (attribute) => (e) => {\n    track[attribute] = e.target.value;\n    setTrack(track);\n  };\n\n  return (\n    <div className={styles.editable}>\n\n      <label className={styles.label}>Formula</label>\n      <Input\n        isError={!isFormulaValid}\n        color={track.color}\n        index={index}\n        value={formula}\n        onChange={createAttributeSetter('formula')}\n      />\n\n      <label className={styles.label}>Note duration (ms)</label>\n      <Input\n        color={track.color}\n        index={index}\n        value={noteDuration}\n        onChange={createAttributeSetter('noteDuration')}\n        type='number'\n      />\n    </div>\n  );\n};\n\nconst Icons = ({ \n  isCollapsed,\n  index,\n  track,\n  tracks,\n  setTrack,\n  setTracks,\n}) => {\n  if (isCollapsed) {\n    return null;\n  }\n\n  const onMute = () => {\n    setTrack({\n      ...track,\n      isMuted: !track.isMuted\n    });\n  };\n\n  const onDelete = () => {\n    if (tracks.length === 1) {\n      return;\n    }\n    tracks.splice(index, 1);\n    setTracks([...tracks]);\n  };\n\n  const muteClasses = [styles.icon];\n  if (track.isMuted) {\n    muteClasses.push(styles.isMuted);\n  }\n\n  const MuteIcon = track.isMuted ? FaVolumeMute : FaVolumeDown;\n\n  return (\n    <div className={styles.icons}>\n      <div\n        title='Mute'\n        onClick={onMute}\n        className={muteClasses.join(' ')}\n      >\n        <MuteIcon className={styles.muteIcon} />\n      </div>\n      <div\n        title='Delete'\n        onClick={onDelete}\n        className={styles.icon}\n      >\n        <FaTrash className={styles.trashIcon} />\n      </div>\n    </div>\n  );\n};\n\nconst TrackOptions = ({\n  index,\n  track,\n  tracks,\n  setTracks,\n  setTrack\n}) => {\n\n  const [isCollapsed, setIsCollapsed] = useState(index !== 0);\n\n  const color = track.color;\n  const borderColor = color;\n  const backgroundColor = color + OPACITY_1;\n  const containerStyle = { borderColor, backgroundColor };\n  const containerClasses = [styles.container];\n  if (isCollapsed) {\n    containerClasses.push(styles.collapsed)\n  }\n\n  const onClickContainer = (e) => {\n    setIsCollapsed(!isCollapsed);\n  };\n\n  return (\n    <div\n      style={containerStyle}\n      className={containerClasses.join(' ')}\n    >\n      <div className={styles.header}>\n        <div\n          onClick={onClickContainer} \n          className={styles.title}\n        >\n          Track {index + 1}\n        </div>\n        <Icons\n          index={index}\n          isCollapsed={isCollapsed}\n          track={track}\n          tracks={tracks}\n          setTrack={setTrack}\n          setTracks={setTracks}\n        />\n      </div>\n      {isCollapsed\n        ? null\n        : <Inputs\n            track={track} \n            index={index} \n            setTrack={setTrack} \n          />\n      }\n    </div>\n  );\n};\n\nexport default TrackOptions;","import _ from 'lodash';\nimport { useEffect, useMemo, useState } from 'react';\nimport { SCALES } from '../../constants/scales';\nimport { createAudioNodes, resetAudioNodes } from '../../util/audioPlayer';\nimport { calculateNotes } from '../../util/noteCalculator';\nimport { loadInitialState } from '../../util/stateLoader';\nimport { storeRecent } from '../../util/storageManager';\nimport AddTrack from '../AddTrack/AddTrack';\nimport Chart from '../Chart/Chart.js';\nimport EnabledNotes from '../EnabledNotes/EnabledNotes';\nimport Header from '../Header/Header';\nimport Load from '../Load/Load';\nimport LoopOptions from '../LoopOptions/LoopOptions';\nimport More from '../More/More';\nimport Play from '../Play/Play';\nimport Save from '../Save/Save';\nimport TimelineArm from '../TimelineArm/TimelineArm';\nimport TrackOptions from '../TrackOptions/TrackOptions.js';\nimport styles from './App.module.css';\n\nconst App = () => {\n\n  const [tracks, setTracks] = useState([]);\n  const [bpm, setBpm] = useState(60);\n  const [numBeats, setNumBeats] = useState(16);\n  const [noteRange, setNoteRange] = useState(14);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [scale, setScale] = useState(SCALES[3]);\n  const [lowNote, setLowNote] = useState('E3');\n\n  // Calculate notes to play ===================================================\n\n  const notes = useMemo(() => {\n    return calculateNotes(\n      tracks,\n      numBeats,\n      noteRange,\n      scale,\n      lowNote\n    );\n  }, [tracks, numBeats, noteRange, scale, lowNote]);\n\n  // On page load ==============================================================\n\n  useEffect(() => {\n    const {\n      tracks,\n      bpm,\n      numBeats,\n      noteRange,\n      scale,\n      lowNote\n    } = loadInitialState();\n    setTracks(tracks);\n    setBpm(bpm);\n    setNumBeats(numBeats);\n    setNoteRange(noteRange);\n    setScale(scale);\n    setLowNote(lowNote);\n  }, []);\n\n  // Playing and pausing audio =================================================\n\n  useEffect(() => {\n    if (isPlaying) {\n      createAudioNodes(\n        tracks,\n        notes,\n        bpm,\n        numBeats\n      );\n    } else {\n      resetAudioNodes();\n    }\n  }, [\n    isPlaying,\n    tracks,\n    notes,\n    bpm,\n    numBeats\n  ]);\n\n  // Local storage =============================================================\n\n  const saveData = useMemo(() => ({\n    bpm,\n    numBeats,\n    noteRange,\n    scale,\n    lowNote,\n    tracks\n  }), [bpm, numBeats, noteRange, scale, lowNote, tracks]);\n\n  useEffect(() => {\n    window.history.pushState({}, '', window.location.origin + window.location.pathname);\n    storeRecent(saveData);\n  }, [saveData]);\n\n  // Event handlers ============================================================\n\n  const createSetTrack = (index) => (track) => {\n    const newTracks = _.cloneDeep(tracks);\n    newTracks[index] = track;\n    setTracks(newTracks);\n  };\n\n  // Page content ==============================================================\n\n  return (\n    <div className={styles.app}>\n      <div>\n\n        <Header />\n\n        <div className={styles.row}>\n\n          {/* Left section ================================================= */}\n          <div className={styles.left}>\n            <div className={styles.chart}>\n              <Chart\n                tracks={tracks}\n                numBeats={numBeats}\n                notes={notes}\n              />\n              <TimelineArm\n                isPlaying={isPlaying}\n                bpm={bpm}\n                numBeats={numBeats}\n              />\n            </div>\n            {tracks.map((track, index) => (\n              <EnabledNotes\n                key={index}\n                numBeats={numBeats}\n                track={track}\n                setTrack={createSetTrack(index)}\n              />\n            ))}\n          </div>\n\n          {/* Right section ================================================ */}\n          <div className={styles.right}>\n            <div className={styles.buttons}>\n              <Play\n                isPlaying={isPlaying}\n                setIsPlaying={setIsPlaying}\n              />\n              <AddTrack\n                tracks={tracks}\n                setTracks={setTracks}\n              />\n              <Save saveData={saveData} />\n              <Load \n                setBpm={setBpm}\n                setNumBeats={setNumBeats}\n                setNoteRange={setNoteRange}\n                setScale={setScale}\n                setLowNote={setLowNote}\n                setTracks={setTracks}\n              />\n              <More\n                saveData={saveData}\n                notes={notes}\n              />\n            </div>\n            {tracks.map((track, index) => (\n              <TrackOptions\n                key={index}\n                index={index}\n                track={track}\n                tracks={tracks}\n                setTrack={createSetTrack(index)}\n                setTracks={setTracks}\n              />\n            ))}\n          </div>\n\n        </div>\n      </div>\n\n      <LoopOptions\n        scale={scale}\n        lowNote={lowNote}\n        bpm={bpm}\n        numBeats={numBeats}\n        noteRange={noteRange}\n        setScale={setScale}\n        setLowNote={setLowNote}\n        setBpm={setBpm}\n        setNumBeats={setNumBeats}\n        setNoteRange={setNoteRange}\n      />\n    </div>\n  )\n}\n\nexport default App;","import _ from 'lodash';\nimport { formulaToData } from './formulaEvaluator';\n\nexport const calculateNotes = (\n  tracks,\n  numBeats,\n  noteRange,\n  scale,\n  lowNote\n) => {\n  const minNoteIndex = scale.notes.indexOf(lowNote);\n\n  const xValues = [];\n  for (let i = 0; i < numBeats; i++) {\n    xValues.push(i / numBeats * 2 * Math.PI);\n  }\n\n  const yValuesArray = tracks.map(({ formula }) => {\n    try {\n      const data = formulaToData(formula, xValues);\n      return data.yValues;\n    } catch (e) {\n      return [];\n    }\n  });\n\n  const yMin = _(yValuesArray).flatten().min();\n  const yMax = _(yValuesArray).flatten().max();\n\n  const notesArray = yValuesArray.map((yValues) => {\n\n    const noteIndices = yValues.map((y) => {\n      return Math.round(\n        (y - yMin) / \n        ((yMax - yMin) || 1) *\n        (noteRange - 1)\n      );\n    });\n\n    const notes = noteIndices.map((index) => {\n      return scale.notes[index + minNoteIndex];\n    });\n\n    return notes;\n  });\n\n  return notesArray;\n};\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './components/App/App';\nimport './index.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"App_app__1IksY\",\"row\":\"App_row__2IEL-\",\"left\":\"App_left__1u-q5\",\"chart\":\"App_chart__1PrK6\",\"right\":\"App_right__3pQWj\",\"buttons\":\"App_buttons__22Fcg\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"buttons\":\"EnabledNotes_buttons__YuCJP\",\"muted\":\"EnabledNotes_muted__2I7zC\",\"button\":\"EnabledNotes_button__3316l\",\"disabled\":\"EnabledNotes_disabled__1W2ff\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"Header_container__1VC87\",\"text\":\"Header_text__G3J9D\",\"link\":\"Header_link__2wI74\",\"line\":\"Header_line__TnUnq\"};"],"sourceRoot":""}